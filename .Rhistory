#
vaWaits = tempt$vaWaits
vaQuits = tempt$vaQuits
wIni = para[5]
gamma = para[3]
nTimeStep = otherPara$tMax / otherPara$stepDuration
vaWaits[is.na(vaWaits[,1]),1] = rep(wIni, sum(is.na(vaWaits[,1])))
vaQuits[is.na(vaQuits[,1]),1] = rep(wIni * gamma ^ (iti / stepDuration),
sum(is.na(vaQuits[,1])))
for(i in 2 : endTick){
vaWaits[is.na(vaWaits[,i]),i] = vaWaits[is.na(vaWaits[,i]),i-1]
vaQuits[is.na(vaQuits[,i]),i] = vaQuits[is.na(vaQuits[,i]),i-1]
}
cIdx = endTick
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
ggplot(plotData, aes(time, va, color = action)) + geom_line()
gamma
gamma ^ 4
3 * (1 - gamma ^ 4)
tau = para[2]
waitProb = exp(vaWaits * tau) / (exp(vaWaits*tau) + exp(vaQuits* tau))
plotData$waitProb = waitProb[,endTick]
ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
ggplot(plotData, aes(time, va, color = action)) + geom_line()
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
ggplot(plotData, aes(time, va, color = action)) + geom_line()
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
p = ggplot(plotData, aes(time, va, color = action)) + geom_line()
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
View(vaQuits)
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
# p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
plotData$waitProb = waitProb[,i]
p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
# plotData$waitProb = waitProb[,i]
# p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
#   ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 11 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
# plotData$waitProb = waitProb[,i]
# p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
#   ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 11 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
# plotData$waitProb = waitProb[,i]
# p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
#   ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 11 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
# plotData$waitProb = waitProb[,i]
# p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
#   ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label)
# plotData$waitProb = waitProb[,i]
# p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
#   ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('reward = %d, timeWaited =%.2f',
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label) +
xlim(c(0,3))
# plotData$waitProb = waitProb[,i]
# p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
#   ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 1 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('last, rwd = %d, tw = %.2f; rwd = %d, tw =%.2f',
tempt$trialEarnings[i-1], waitDuration[i-1],
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label) +
xlim(c(0,3))
# plotData$waitProb = waitProb[,i]
# p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
#   ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
label = sprintf('last, rwd = %d, tw = %.2f; rwd = %d, tw =%.2f',
tempt$trialEarnings[i-1], waitDuration[i-1],
tempt$trialEarnings[i], waitDuration[i])
label
for(i in 2 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('last, rwd = %d, tw = %.2f; rwd = %d, tw =%.2f',
tempt$trialEarnings[i-1], waitDuration[i-1],
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label) +
xlim(c(0,3))
# plotData$waitProb = waitProb[,i]
# p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
#   ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 2 : endTick){
vaWaits[is.na(vaWaits[,i]),i] = vaWaits[is.na(vaWaits[,i]),i-1]
vaQuits[is.na(vaQuits[,i]),i] = vaQuits[is.na(vaQuits[,i]),i-1]
}
for(i in 2 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('last, rwd = %d, tw = %.2f; rwd = %d, tw =%.2f',
tempt$trialEarnings[i-1], waitDuration[i-1],
tempt$trialEarnings[i], waitDuration[i])
# p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label) +
#   xlim(c(0,3))
plotData$waitProb = waitProb[,i]
p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
ggtitle(label)
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 2 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('last, rwd = %d, tw = %.2f; rwd = %d, tw =%.2f',
tempt$trialEarnings[i-1], waitDuration[i-1],
tempt$trialEarnings[i], waitDuration[i])
# p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label) +
#   xlim(c(0,3))
plotData$waitProb = waitProb[,i]
p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
ggtitle(label) + xlim(c(1,3))
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 2 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('last, rwd = %d, tw = %.2f; rwd = %d, tw =%.2f',
tempt$trialEarnings[i-1], waitDuration[i-1],
tempt$trialEarnings[i], waitDuration[i])
# p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label) +
#   xlim(c(0,3))
plotData$waitProb = waitProb[,i]
p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
ggtitle(label) + xlim(c(1,3))
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 2 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('last, rwd = %d, tw = %.2f; rwd = %d, tw =%.2f',
tempt$trialEarnings[i-1], waitDuration[i-1],
tempt$trialEarnings[i], waitDuration[i])
p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label) +
xlim(c(0,3))
# plotData$waitProb = waitProb[,i]
# p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
#   ggtitle(label) + xlim(c(1,3))
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
for(i in 2 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('last, rwd = %d, tw = %.2f; rwd = %d, tw =%.2f',
tempt$trialEarnings[i-1], waitDuration[i-1],
tempt$trialEarnings[i], waitDuration[i])
# p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label) +
#   xlim(c(0,3))
plotData$waitProb = waitProb[,i]
p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
ggtitle(label) + xlim(c(1,3))
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
vaWaits[10]
for(i in 2 : endTick){
vaWaits[is.na(vaWaits[,i]),i] = vaWaits[is.na(vaWaits[,i]),i-1]
vaQuits[is.na(vaQuits[,i]),i] = vaQuits[is.na(vaQuits[,i]),i-1]
}
for(i in 2 : endTick){
cIdx = i
plotData = data.frame(va =c(vaWaits[,cIdx], vaQuits[,cIdx]),
time = rep( 1 : (otherPara$tMax / otherPara$stepDuration), 2),
action = rep(c('wait', 'quit'),
each = otherPara$tMax / otherPara$stepDuration))
label = sprintf('last, rwd = %d, tw = %.2f; rwd = %d, tw =%.2f',
tempt$trialEarnings[i-1], waitDuration[i-1],
tempt$trialEarnings[i], waitDuration[i])
# p = ggplot(plotData, aes(time, va, color = action)) + geom_line() + ggtitle(label) +
#   xlim(c(1,3)) + xlab('step')
plotData$waitProb = waitProb[,i]
p = ggplot(plotData[plotData$action == 'wait',], aes(time, waitProb)) + geom_line()+
ggtitle(label) + xlim(c(1,3)) + xlab('step')
print(p)
readline(prompt = paste(i, '(hit ENTER to continue)'))
}
vaWaits[1:5,10]
vaQuits[1:5,10]
# this script is for
# outFile
outFile = 'QStar_figures'
# library
library("ggplot2")
library("dplyr")
library("tidyr")
library('scales')
source('plotTheme.R')
source('wtwSettings.R')
# initialSpace
nPara = 5
nValue = 3
tMax = otherPara[['tMax']]
initialSpace = matrix(NA, nValue^nPara, nPara)
initialSpace[,1] = rep(seq(0.2, 0.8, 0.3), each = nValue^(nPara - 1)) # phi
initialSpace[,2] = rep(rep(seq(8,24, 8), each = nValue), nValue^(nPara - 2)) # tau
initialSpace[,3] = rep(rep(seq(0.90, 0.98, 0.04), each = nValue^2), nValue^(nPara - 3))
initialSpace[,4] = rep(rep(seq(0.90, 0.98, 0.04), each = nValue^3), nValue^(nPara - 4))
initialSpace[,5] = rep(rep(seq(2, 8, 3), each = nValue^4), nValue^(nPara - 5))
####
load('QStarData/colpData.RData')
load('QStarData/rawWTW.RData')
load('QStarData/hdrData.RData')
####
plotData = data.frame(totalEarnings = c(colpHPData$totalEarnings, colpLPData$totalEarnings),
condition = rep(c("HP", "LP"), each = nComb), phi = initialSpace[,1],
tau = initialSpace[,2], gamma = initialSpace[,3],
lambda = initialSpace[,4], wIni = initialSpace[,5]
)
ggplot(plotData, aes(totalEarnings)) + geom_histogram(bins = 15) +
facet_wrap(~condition, nrow = 1) + xlab('Total earnings') + ylab("Num of simulations") + saveTheme + xlim(c(0, 600))
fileName = file.path(outFile, 'earningSml.pdf')
plotData = data.frame(totalEarnings = c(colpHPData$totalEarnings, colpLPData$totalEarnings),
condition = rep(c("HP", "LP"), each = nComb), phi = initialSpace[,1],
tau = initialSpace[,2], gamma = initialSpace[,3],
lambda = initialSpace[,4], wIni = initialSpace[,5]
)
# initialSpace
nPara = 5
nValue = 3
tMax = otherPara[['tMax']]
initialSpace = matrix(NA, nValue^nPara, nPara)
initialSpace[,1] = rep(seq(0.2, 0.8, 0.3), each = nValue^(nPara - 1)) # phi
initialSpace[,2] = rep(rep(seq(8,24, 8), each = nValue), nValue^(nPara - 2)) # tau
initialSpace[,3] = rep(rep(seq(0.90, 0.98, 0.04), each = nValue^2), nValue^(nPara - 3))
initialSpace[,4] = rep(rep(seq(0.90, 0.98, 0.04), each = nValue^3), nValue^(nPara - 4))
initialSpace[,5] = rep(rep(seq(2, 8, 3), each = nValue^4), nValue^(nPara - 5))
plotData = data.frame(totalEarnings = c(colpHPData$totalEarnings, colpLPData$totalEarnings),
condition = rep(c("HP", "LP"), each = nComb), phi = initialSpace[,1],
tau = initialSpace[,2], gamma = initialSpace[,3],
lambda = initialSpace[,4], wIni = initialSpace[,5]
)
nComb = nValue ^ nPara
####### plot distribution of totalEarnings
plotData = data.frame(totalEarnings = c(colpHPData$totalEarnings, colpLPData$totalEarnings),
condition = rep(c("HP", "LP"), each = nComb), phi = initialSpace[,1],
tau = initialSpace[,2], gamma = initialSpace[,3],
lambda = initialSpace[,4], wIni = initialSpace[,5]
)
ggplot(plotData, aes(totalEarnings)) + geom_histogram(bins = 15) +
facet_wrap(~condition, nrow = 1) + xlab('Total earnings') + ylab("Num of simulations") + saveTheme + xlim(c(0, 600))
fileName = file.path(outFile, 'earningSml.pdf')
facet_wrap(~condition, nrow = 1) + xlab('Total earnings') + ylab("Num of simulations") + saveTheme + xlim(c(0, 600))
fileName = file.path(outFile, 'earningSml.pdf')
ggsave(fileName, width = 16, height = 8)
ggsave(fileName, width = 16, height = 8)
# calculate range
summarise(group_by(plotData, condition),
minEarning = min(totalEarnings),
maxEarning = max(totalEarnings))
perc = 0.1
nUse= floor(nComb* perc);
rankings = c('Top', 'Bottom')
for(c in 1 : 2){
cond = conditions[c]
condName = conditionNames[c]
condColor = conditionColors[c]
if(condName == 'HP'){
hdrData = hdrHPData
inputData = colpHPData
}else{
hdrData = hdrLPData
inputData = colpLPData
}
for(r in 1:2){
ranking = rankings[r]
tempt = order(inputData$totalEarnings, decreasing = (ranking == 'Top'))
UseVaWaits = inputData$vaWaits[tempt[1:nUse],]
UseVaQuits= inputData$vaQuits[tempt[1:nUse],]
# plot
vas = cbind(UseVaWaits, UseVaQuits)
meanValues = apply(vas, FUN = function(x) mean(x[!is.na(x)]), MARGIN = 2)
stdValues = apply(vas, FUN = function(x) sd(x[!is.na(x)]), MARGIN = 2)
maxValues = meanValues + stdValues
minValues = meanValues - stdValues
actions = factor(rep(c('wait', 'quit'), each = hdrData$nTimeStep), levels = c('wait', 'quit'))
plotData = data.frame(meanValues, stdValues, maxValues, minValues,
timeSteps = rep(seq(1,hdrData$nTimeStep),2), actions )
graphics.off()
titleText = sprintf("%s, %s%s total earnings",condName, ranking, percent(perc))
ggplot(plotData, aes(timeSteps, meanValues, linetype = actions)) +
geom_ribbon(data = plotData[plotData$actions == 'wait',], aes(ymin=minValues, ymax=maxValues),linetype=0, alpha = 0.1, color = "#bababa") +
geom_ribbon(data = plotData[plotData$actions == 'quit',], aes(ymin=minValues, ymax=maxValues),linetype=0, alpha = 0.1, color = "#bababa") +
geom_line(color = conditionColors[c], size = 1) + xlab('Time step') + ylab('Action value') + ggtitle(titleText)+ saveTheme +
scale_linetype_discrete(name = "Action")
#coord_cartesian(ylim=c(-2,5))
fileName = sprintf('%s/actionValue%s%s.pdf', outFile, condName, ranking)
ggsave(file = fileName, width = 10, height = 6)
}
}
######### plot aucCompare and wtwCompare #######
plotData = rbind(as.data.frame(colpHPData[c(1,5,6,7)]),
as.data.frame(colpLPData[c(1,5,6,7)]))
plotData$condition = rep(c('HP', 'LP'), each = length(colpHPData$totalEarnings))
plotData = plotData %>% arrange(totalEarnings) %>%group_by(condition) %>%
mutate(earningRank = rank(totalEarnings, ties.method = "first"))
ggplot(plotData, aes(condition, AUC)) + geom_jitter(aes(color =  earningRank ), size = 4) +
scale_color_gradient(low="red", high="yellow", name = 'Earning ranking') +
geom_segment(aes(x= 0.7, xend = 1.3, y=optimWaitTimes$HP,yend=optimWaitTimes$HP), size = 2) +
geom_segment(aes(x= 1.7, xend = 2.3, y=optimWaitTimes$LP,yend=optimWaitTimes$LP), size = 2) + saveTheme
fileName = file.path(outFile, "acuCompare.pdf")
ggsave(fileName, width = 12, height = 8)
plotData2 = plotData[rep(initialSpace[,2] == 24, 2), ]
ggplot(plotData2[plotData2$condition == 'LP',], aes(AUC, totalEarnings)) + geom_point() +
saveTheme + ylab('Total earnings')
fileName = file.path(outFile, "AUCLP_earningsLP2.pdf")
ggsave(fileName, width = 6, height = 4)
ggplot(plotData2[plotData2$condition == 'LP',], aes(AUC, totalEarnings)) + geom_point() +
saveTheme + ylab('Total earnings')
fileName = file.path(outFile, "AUCLP_earnings.pdf")
ggsave(fileName, width = 6, height = 4)
